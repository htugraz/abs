diff --git a/gtk/deprecated/gtktrayicon-x11.c b/gtk/deprecated/gtktrayicon-x11.c
index 503d64b..bfd6b9d 100644
--- a/gtk/deprecated/gtktrayicon-x11.c
+++ b/gtk/deprecated/gtktrayicon-x11.c
@@ -355,6 +355,27 @@ gtk_tray_icon_draw (GtkWidget *widget,
       cairo_set_operator (cr, CAIRO_OPERATOR_SOURCE);
       cairo_paint (cr);
     }
+  else
+    {
+      GdkRectangle clip;
+
+      if (gdk_cairo_get_clip_rectangle (cr, &clip))
+        {
+          /* Clear to parent-relative pixmap
+           * We need to use direct X access here because GDK doesn't know about
+           * the parent realtive pixmap. */
+          cairo_surface_flush (target);
+
+          XClearArea (GDK_WINDOW_XDISPLAY (window),
+                      GDK_WINDOW_XID (window),
+                      clip.x, clip.y,
+                      clip.width, clip.height,
+                      False);
+          cairo_surface_mark_dirty_rectangle (target, 
+                                              clip.x, clip.y,
+                                              clip.width, clip.height);
+        }
+    }
 
   if (GTK_WIDGET_CLASS (gtk_tray_icon_parent_class)->draw)
     retval = GTK_WIDGET_CLASS (gtk_tray_icon_parent_class)->draw (widget, cr);
@@ -480,6 +501,14 @@ gtk_tray_icon_get_visual_property (GtkTrayIcon *icon)
       icon->priv->manager_visual_rgba = FALSE;
     }
 
+
+G_GNUC_BEGIN_IGNORE_DEPRECATIONS
+  /* For the background-relative hack we use when we aren't
+   * using a real RGBA visual, we can't be double-buffered
+   */
+  gtk_widget_set_double_buffered (GTK_WIDGET (icon), icon->priv->manager_visual_rgba);
+G_GNUC_END_IGNORE_DEPRECATIONS
+
   if (type != None)
     XFree (prop.prop);
 }
diff --git a/gtk/gtkbox.c b/gtk/gtkbox.c
index 613b5ae..72f26e9 100644
--- a/gtk/gtkbox.c
+++ b/gtk/gtkbox.c
@@ -2619,10 +2619,14 @@ gtk_box_set_center_widget (GtkBox    *box,
 
   g_return_if_fail (GTK_IS_BOX (box));
 
+  if (priv->center)
+    {
+      gtk_box_remove (GTK_CONTAINER (box), priv->center->widget);
+      priv->center = NULL;
+    }
+
   if (widget)
     priv->center = gtk_box_pack (box, widget, FALSE, TRUE, 0, GTK_PACK_START);
-  else if (priv->center)
-    gtk_box_remove (GTK_CONTAINER (box), priv->center->widget);
 }
 
 /**
