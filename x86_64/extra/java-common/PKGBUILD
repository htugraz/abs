# Maintainer: Guillaume ALAUX <guillaume@archlinux.org>
pkgname=java-common
pkgver=1
pkgrel=7
pkgdesc='Common files for Java Environments'
arch=('any')
url='www.archlinux.org'
license=('GPL')
checkdepends=('wget')
backup=(etc/profile.d/jre.sh
        etc/profile.d/jre.csh)
# TODO remove after a while
replaces=('java-runtime-headless-meta' 'java-runtime-meta' 'java-environment-meta')
install=install_java-common.sh
source=(profile_jre.csh
        profile_jre.sh
        bin_archlinux-java
        test_archlinux-java
        bin_java-common-wrapper
        https://shunit2.googlecode.com/files/shunit2-2.1.6.tgz)

sha256sums=('72fa8a6d2d38f37ab51d36f383fa94bf424d494f0d3712b3af73daaf30046b2b'
            'ffef7d042be3f20e3225780def56bcbadd75a74a3ceecc57c0af23d78e39cb54'
            '00af7fe1894e0edc7663bfbdd626c68171cad7bc7d499f343f2eee9637d4b4c7'
            'c28ffd3acc702e8cb02b3ec18516c0c4287614dd1f5803f9357a7a4c7c798f35'
            '16a4fde19bd34210ff2d06480085f681b4e41e85ec89853e3cafaa8377bcedfb'
            '65a313a76fd5cc1c58c9e19fbc80fc0e418a4cbfbd46d54b35ed5b6e0025d4ee')

check() {
  cd "${srcdir}"
  ./test_archlinux-java
}

build() {
  cd "${srcdir}"

  install -D -m 644 profile_jre.sh  "${pkgdir}/etc/profile.d/jre.sh"
  install -D -m 644 profile_jre.csh "${pkgdir}/etc/profile.d/jre.csh"
  install -D -m 755 bin_java-common-wrapper "${pkgdir}/usr/lib/java-common-wrapper"
  install -D -m 755 bin_archlinux-java "${pkgdir}/usr/bin/archlinux-java"
}
