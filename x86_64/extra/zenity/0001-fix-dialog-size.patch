From c75c9e877a28e3246eb2f234fea01eb6f1638b6d Mon Sep 17 00:00:00 2001
From: Jan de Groot <jgc@archlinux.org>
Date: Tue, 5 Aug 2014 12:10:14 +0000
Subject: [PATCH] Fix dialog size

Backport of e5eb127e9779b9a58e53b1a7d268b81284ebd241
---
 src/msg.c | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/src/msg.c b/src/msg.c
index f4d5e7a..fe9f1c1 100644
--- a/src/msg.c
+++ b/src/msg.c
@@ -27,7 +27,7 @@
 #include "util.h"
 
 static void zenity_msg_dialog_response (GtkWidget *widget, int response, gpointer data);
-
+static void zenity_text_size_allocate (GtkWidget *widget, GtkAllocation *allocation, gpointer data);
 static void
 zenity_msg_construct_question_dialog (GtkWidget *dialog, ZenityMsgData *msg_data, ZenityData *data)
 {
@@ -159,6 +159,8 @@ zenity_msg (ZenityData *data, ZenityMsgData *msg_data)
       gtk_label_set_markup (GTK_LABEL (text), g_strcompress (msg_data->dialog_text));
   }
 
+  g_signal_connect_after (G_OBJECT (text), "size-allocate", G_CALLBACK (zenity_text_size_allocate), data);
+
   if (msg_data->dialog_icon)
     gtk_image_set_from_icon_name (GTK_IMAGE (image), msg_data->dialog_icon, GTK_ICON_SIZE_DIALOG);
  
@@ -177,6 +179,12 @@ zenity_msg (ZenityData *data, ZenityMsgData *msg_data)
 }
 
 static void
+zenity_text_size_allocate (GtkWidget *widget, GtkAllocation *allocation, gpointer data)
+{
+  gtk_widget_set_size_request (widget, allocation->width, -1);
+}
+
+static void
 zenity_msg_dialog_response (GtkWidget *widget, int response, gpointer data)
 {
   ZenityData *zen_data = data;
-- 
2.0.4

