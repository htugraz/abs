# $Id: PKGBUILD 227804 2014-12-19 21:53:50Z andyrtr $
# Maintainer: Andreas Radke <andyrtr@archlinux.org>
# Maintainer: Bart≈Çomiej Piotrowski <bpiotrowski@archlinux.org>

pkgbase=libreoffice-fresh-i18n

pkgver=4.3.5
pkgrel=1
_rcver=${pkgver}.2
#_oodlver=${pkgver}.0.beta1
_oodlver=${pkgver}

arch=('any')
url="http://www.documentfoundation.org"
license=('LGPL')
makedepends=('rpmextract')

#http://download.documentfoundation.org/mirrors/all.html
_url="http://download.documentfoundation.org/libreoffice/stable"
#_url="http://download.documentfoundation.org/libreoffice/testing"
#_url="http://dev-builds.libreoffice.org/pre-releases"
#_url="http://www.libreoffice.org/download/pre-releases"

#_url+="/${pkgver}-rc2/rpm/x86"
_url+="/${pkgver}/rpm/x86"
#_url+="/rpm/x86"

_languages=(
  'af            "Afrikaans"'
  'am            "Amharic"'
  'ar            "Arabic"'
  'as            "Assamese (India)"'
  'ast           "Asturianu"'
  'be            "Belarusian"'
  'bg            "Bulgarian"'
  'bn            "Bengali"'
  'bn-IN         "Bengali (India)"'
  'bo            "Tibetan"'
  'br            "Breton"'
  'brx           "Bodo"'
  'bs            "Bosnian"'
  'ca            "Catalan"'
  'ca-valencia   "Catalan (Valencia)"'
  'cs            "Czech"'
  'cy            "Welsh"'
  'da            "Danish"'
  'de            "German"'
  'dgo           "Dogri"'
  'dz            "Dzongkha"'
  'el            "Greek"'
  'en-GB         "English (GB)"'
  'en-ZA         "English (ZA)"'
  'eo            "Esperanto"'
  'es            "Spanish"'
  'et            "Estonian"'
  'eu            "Basque"'
  'fa            "Persian"'
  'fi            "Finnish"'
  'fr            "French"'
  'ga            "Irish"'
  'gd            "Gaelic (Scottish)"'
  'gl            "Galician"'
  'gu            "Gujarati"'
  'he            "Hebrew"'
  'hi            "Hindi"'
  'hr            "Croatian"'
  'hu            "Hungarian"'
  'id            "Indonesian"'
  'is            "Icelandic"'
  'it            "Italian"'
  'ja            "Japanese"'
  'ka            "Georgian"'
  'kk            "Kazakh"'
  'km            "Khmer (Cambodia)"'
  'kmr-Latn      "Kurdish"'
  'kn            "Kannada"'
  'ko            "Korean"'
  'kok           "Konkani"'
  'ks            "Kashmiri"'
  'lb            "Luxembourgish"'
  'lo            "Lao"'
  'lt            "Lithuanian"'
  'lv            "Latvian"'
  'mai           "Maithili"'
  'mk            "Macedonian"'
  'ml            "Malayalam"'
  'mn            "Mongolian"'
  'mni           "Manipuri"'
  'mr            "Marathi"'
  'my            "Burmese"'
  'nb            "Norwegian Bokmal"'
  'ne            "Nepali"'
  'nl            "Dutch"'
  'nn            "Norwegian Nynorsk"'
  'nr            "Ndebele (South)"'
  'nso           "Northern Sotho"'
  'oc            "Occitan"'
  'om            "Oromo"'
  'or            "Oriya"'
  'pa-IN         "Punjabi (India)"'
  'pl            "Polish"'
  'pt            "Portuguese"'
  'pt-BR         "Portuguese (Brasil)"'
  'ro            "Romanian"'
  'ru            "Russian"'
  'rw            "Kinyarwanda"'
  'sa-IN         "Sanskrit (India)"'
  'sat           "Santali"'
  'sd            "Sindhi"'
  'si            "Singhalese"'
  'sid           "Sidama"'
  'sk            "Slovak"'
  'sl            "Slovenian"'
  'sq            "Albanien"'
  'sr            "Serbian"'
  'sr-Latn       "Serbian (Latin)"'
  'ss            "Swati"'
  'st            "Southern Sotho"'
  'sv            "Swedish"'
  'sw-TZ         "Swahili (Tanzania)"'
  'ta            "Tamil"'
  'te            "Telugu"'
  'tg            "Tajik"'
  'th            "Thai"'
  'tn            "Tswana"'
  'tr            "Turkish"'
  'ts            "Tsonga"'
  'tt            "Tatar"'
  'ug            "Uighur"'
  'uk            "Ukrainian"'
  'uz            "Uzbek"'
  've            "Venda"'
  'vi            "Vietnamese"'
  'xh            "Xhosa"'
  'zh-CN         "Chinese (simplified)"'
  'zh-TW         "Chinese (traditional)"'
  'zu            "Zulu"'
)
md5sums=('099491600411ddaf521143e622e03872'
         '0a3b7e4bdcaf16b95f4227a39bdb8368'
         'dadd5a3fba52ef316c2b7375237789f9'
         '580c8a1006ecedd088e62f0c7b49b752'
         '409cbe6c339f91e4b46eec990e40f1ce'
         '77fb264426dc547f0d483c5c663d6f60'
         'f1b7f70305dbe80849e946c4c8bbf21a'
         '8a1465194aa7d90fc597f95441892d7a'
         'efd8faf6146f6625811493479be22832'
         '7fb4340266c97bd7d1dd179f8262fe23'
         '911b4199b01816a8aba876ff1b4866c3'
         '0f0417d15cef9a6c49897a0ca0f1c2d6'
         'f52948723eb5507f9b036d3c9f5c4d5d'
         'b861b2a0f8d2665c8a2a516ceabbecf9'
         '4990296df1cd6d3986111e7f662efd18'
         '806180a1915e61e6addcf38ec82f5215'
         '5b42ad7385f8ba9db61046b2b499f53e'
         '5386d53f8db8bb56db593708e54a8168'
         'e33a723e7c203011b2166f16af4a37a2'
         '7f8ea1f035b06232481999a25be3d381'
         '9199542d9d6af3a0c458b0fe79f0f9a6'
         '3ecbb9c33dbc7d73430ab27ebbf2aa6e'
         '790bfb1decd2eb48790fec8d7c154c1e'
         'f3619477b188f2136e8a1036018fad29'
         '198389bdd5be95ccdd2fabbf58d16039'
         'df448cd810a9636453436f9b184db958'
         '679bfc33df8accd0b0128a5592a8b455'
         'd02811392647fe4a390ab64fb7432985'
         'b7a27d7823640eeab3129c31f7ab49a8'
         'b4098baa5eb539d33ad2a57fe0064342'
         '03c72e021ccf0f4480424bdea6bd6c6a'
         '8a9c5a7c17dc4fa99abb5acc2a1e2221'
         '66eb4c3335a0eaa73a1124f8d73b9d8b'
         '7069d8e4d0778c0eaaa7f5fc880e792d'
         'bfdea7c7a3827391091cadc403965088'
         '1e79a5921f5ab1310a5bf8552d093452'
         'f1ca0517852e4bd683f55a17bd2c72ca'
         'c19ea87f78c9ccb295ff64e6bdf6b358'
         '7ecae0377938aa6afddce43b8f755bc4'
         '7037816206a530feecbf952a0073da4c'
         '38818adf561394fac0e1f763b4d0477a'
         'ceb867d443437808634f17c73a2d530c'
         '93e1b5033d308b8a5bc7cb12affe7f08'
         '9d6d85ed4b7ab4d4145b616edcec642c'
         '6422eec707b3ee2c136bd8c0c3f13d40'
         '6f89c1d5e4ea2cdbc4541b09cc46bd94'
         '18980df6fc9068e1a6473f2614df8fa3'
         '2045cff75b9034b9c3e5f24b5d27a6e1'
         '46573b4a545f41e8ed5a97c3f3f278d6'
         '89cf125568b4d7336df49788efd770cc'
         '4914b2b4c8e4d505181d0c01889985ca'
         '79c538fa6c9a1fc336e8cb6f083f0912'
         'c81dde0c1d8a3f4f9735785299e10802'
         '64b76a491425cdc08ea5415a5157ae56'
         '87ff23970a68522c343cb227dec1180a'
         'fe46607a0945ff5458ba8ae4fe6cbb1a'
         'c24b6cd2b8c9ea394d3c0755a6113ef0'
         '3f4711aed29b8c9d814a18d83b9dc641'
         'd0d95fb553dd61d90ccf631f978bd578'
         'a1963e850c31aad11f749210de7d23b1'
         '92b0f6a6399f248154ba0ad6e2232117'
         'b87077b80e7074ee9d82b39a66dadf62'
         '13b04574cee012f81d8b0a33fd9ac6e9'
         '81cacc43621e60fa5456a8fd8a2bd216'
         'ff72111493e0cc2c150e27f37db02641'
         '22b118a2aadf5885f74b76967abbdc87'
         '0ccf2b56e4c708239d754684a18c8d7a'
         '1d159a3f6f96138008bf195441391b53'
         '3d5f83c4c8591530891ccd03ad6da8e9'
         '5c82003a10a2f4277fa43db798b232b3'
         '890995382b7ece0e00bb3ee869ceacb0'
         '56adb5a8915a37062c03936e52666054'
         '1fa966e592a917ff79d3b46766248fad'
         'e9547ef02d54eec9a192837f70b6a963'
         'e8a6731fb2e977da3dbd9fef8d6e3425'
         '863f47e4341742dfd4b2d49866a1e9ba'
         '0b87ab011d15aa2b1d827c881bec95d5'
         '8352a47b9b7c912044923750345feac2'
         '81e23bffc9c23c8b7adc645f6dd0ab0d'
         'daa8dfedce5f1fe919b45c493640c59f'
         'ae56ffa10d5b9198c8a3921ea45bd936'
         'fe91c55fa96aebab41519677eb75903a'
         'd9bc4a6bc515e64753bdf6d8d7a569d1'
         '91b931981cab94c3d83a759734deaea4'
         '6bb30d0f1b7d72dc94175d61bbffe9a0'
         'ab280743b331804e6f32a7d33644e507'
         'd26150ff0978b49068506dc8f0fb2634'
         'f0af01602de1149fcc09d992fbdcf7cc'
         '95617b7d62a1877ee03a75aa5e47f411'
         '15eb05904de67d91a4413f338928f5e1'
         'fc0e24e287f211bb029507ba4106f7b1'
         '588e014168090c03032400c04a16ce87'
         '418273880726f2167255e8f82a9e3fb6'
         'edf891d64d1f1e7188deaa4ecece278e'
         '65ebc2ded2fac434d907f36e7d1f2139'
         'a1bef52da5db47ec660f87dddbb5d1c7'
         'e3fc673ecb5e55a89413f71f824e4060'
         '6a08c40893dc00d9582772375d822013'
         'aa5fc70bcadf89f59956ec64a3b2cea4'
         'c4d84d52ad96ea90dbf962d9c3440bac'
         '1c8e053d14a8796f76a10b39906286d2'
         'e02a4ff5458044f13251338bcad4a2f0'
         'e8b0976716bae6f3b31ad4fb3cf7f5bf'
         '7d980132ee7d10c874be5d9ee1f752d0'
         'fbbfb934e93ccb5207ae9a36e33c7051'
         '132b9c4811944a5396668ac1a8057628'
         'cbdfdd86718d6dc29b5a949717021493'
         '90bd9ce6ae0cd9bdb109c770a8a27e3e'
         'a31b91a013f3383f06bbe91c7066f478'
         'adea6ed34221ef64be152e6485abf707'
         '3c547d5dae6d5cedf0c17c1519aba377'
         'a0401eca9f95be9bb752a9020dbc3449'
         'cd19fc8f190ebbaa0d33fb9f99b56b05'
         '74455fc2df45657470ae356fb7416174'
         'bfecc5a39bb9cac074fb2b5a60ff650d'
         'ae360a76f84d6743c40ab6bdb7a223c3'
         '966b6d14d141a783ac4ade0e3bfc5111'
         'a045fb49738aa05a0ef5cebcaa622dcf'
         '7f8614846079ba54f2499497531e3aae'
         '4ee20f55ebcb165a9853e94636cd6734'
         '91ee0b698e5d9838ecef13fb09834f05'
         '46b814738aedb15e3892044bd7f83bbd'
         'aa6e6e899777cc9df5e502f524056082'
         'd29fc41b37188e893d28c1a7827ca2ea'
         '3354657e9c23cfb4d9a59152f9dbc4fa'
         '98032669f78ea8e6a80ec5bf4f76fea9'
         '3ca4b4b4be3b1762e085977ea6b1576c'
         '8ae67713be31889458608468cb05cead'
         'e3b40e6ea32268de718b21b8e6213a03'
         '5bd78e9e3a73b17178a03a950ee59f90'
         '49771e29e3df7a50cf47b64aa1a830ff'
         '41dfb3c04b27a030726b145137f4596f'
         '46dfe87cafdede10b01ee79a8609eda7'
         'f77430b1bb3d7441dd504a69411f9a58'
         'f83ea17280fa13d344e0bc79e52b6c42'
         '0f430da461dfc19089a24dbd0728ddf4'
         '7a1a71d72aad2a6b2dc01ae276efb217'
         '9e6b2feb20d66e64909fade1a3820db3'
         '82ee864bb15e87929ca1145e31a0af28'
         '73b3b48059999c6b80a191a415458b04'
         '4d282b59c0229e7577be9984f478c5a3'
         '6ea005b61b803b20ccd1b779cbaf7a49'
         '56f9ed0c3631ded20235094850151d73'
         '3a9a635d87e1beda7fc7a46f074a72d3'
         'e685c25336120aa32356557ed514ffac'
         'b5b1c8fa588e5a889b19b111babc4bc6'
         'ae20f442180958bbcd6de1e88899f33f'
         'aab12a0e86e24b5680d86069e87160b8'
         '13b89fc9985baeccfba70604940498c3'
         'b810585f05d67d7ad7a03100ff71b502'
         'a040043c9d1281dcca9501132ace0fda'
         '571246232ff24a9237dc800dcac2aeb0'
         '7267b1bc6d934d1076277b1f97db9a38'
         'ed98a2089e5683d338fd9d968985b599'
         '23cb4f84f8ad6d1c05780903a0b390cb'
         'da26aec5089c0f4eb6f1087003a19c58'
         '9b334d5d8c395429a02e5e16a2fc91ae'
         'f8f5af8c315a11ceebd732382a804d1b'
         '1a2d44cf593df444b04b64e624935a90'
         'df943599dd741d22c0d358ad52b8bc73'
         '3750a1ad0163c73b408d067549b9afa1'
         '531bc6e1290579a5893b33e2b0e8152c'
         '05794dbf25aaa293829f2cbd9c430462'
         'c987acdb372a39d1f63d5e8769e06ebb'
         'ed96e1aed68c96084145455e716c1470'
         'eee18bdd95f980f12394d28ff62ad1f1')

prepare() {
  for i in ${pkgname[@]}; do
    _pkglang=${i#*-}
    _pkglang=${_pkglang/fresh-}

    echo ${_pkglang} " unpacking..."
    cd "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_${_pkglang}/RPMS

    # remove dictionaries if shipped - we ship them now in separate packages
    rm -vf *-dict-*.rpm || /bin/true

    for j in *.rpm
      do rpmextract.sh $j
    done

    # the helppack rpm goes also into the langpack dir
    rpmextract.sh \
      "${srcdir}"/LibreOffice_${_rcver}_Linux_x86_rpm_helppack_${_pkglang}/RPMS/*.rpm \
      || true
  done
}

_package() {
  pkgdesc="$2 language pack for LibreOffice Fresh"
  depends=('libreoffice-fresh')
  provides=("openoffice-$1" "libreoffice-$1")
  conflicts=("openoffice-$1" "libreoffice-$1")
  replaces=("openoffice-$1")

  cd "$srcdir"/LibreOffice_${_rcver}_Linux_x86_rpm_langpack_$1/RPMS
  mkdir -p "$pkgdir"/usr/lib/libreoffice
  cp -R opt/libreoffice*/* "$pkgdir"/usr/lib/libreoffice
  chown root:root -R "$pkgdir"/usr/lib/libreoffice
}

for _lang in "${_languages[@]}"; do
  _locale=${_lang%% *}
  _pkgname=libreoffice-fresh-$_locale
  source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_langpack_${_locale}.tar.gz)

  if curl -o /dev/null -s -I -f ${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz; then
    source+=(${_url}/LibreOffice_${_oodlver}_Linux_x86_rpm_helppack_${_locale}.tar.gz)
  fi

  pkgname+=($_pkgname)
  eval "package_${_pkgname}() {
    _package $_lang
  }"
done
