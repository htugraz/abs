# $Id: PKGBUILD 99648 2013-10-30 17:30:37Z mtorromeo $
# Maintainer: Massimiliano Torromeo <massimiliano.torromeo@gmail.com>
# Contributor: Kovivchak Evgen <oneonfire@gmail.com>

pkgname=jemalloc
pkgver=3.4.1
pkgrel=2
pkgdesc="General-purpose scalable concurrent malloc implementation"
arch=('i686' 'x86_64')
license=('BSD')
url="http://www.canonware.com/jemalloc/"
depends=('glibc')
makedepends=('autoconf' 'make' 'bash')
optdepends=(
	'perl: memory profiler'
)
source=(http://www.canonware.com/download/jemalloc/$pkgname-$pkgver.tar.bz2)

build() {
	cd "$srcdir/$pkgname-$pkgver"
	./configure --prefix=/usr
	make
}

package() {
	cd "$srcdir/$pkgname-$pkgver"
	make DESTDIR="$pkgdir" install
	mv "$pkgdir"/usr/bin/{,jemalloc-}pprof
	chmod 644 "$pkgdir"/usr/lib/*.a
	install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
}

sha256sums=('7341953fe9f21342b005b6c7e798631678ae713293a64d5fa61dea7449fc10fb')
