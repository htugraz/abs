--- a/src/tcpip.cpp
+++ b/src/tcpip.cpp
@@ -262,7 +262,7 @@ void tcpip::print_packet(const u_char *d
     else if(demux.opt.output_strip_nonprint){
 	for(const u_char *cc = data;cc<data+length;cc++){
 	    if(isprint(*cc) || (*cc=='\n') || (*cc=='\r')){
-		written += fputc(*cc,stdout);
+		written += (fputc(*cc,stdout)!=EOF);
 	    }
 	}
     }
