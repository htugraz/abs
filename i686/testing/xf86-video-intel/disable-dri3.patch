From 86b58835fce56ae13453a89a0b0d93c9517c2758 Mon Sep 17 00:00:00 2001
From: Hans de Goede <hdegoede@redhat.com>
Date: Thu, 12 Jun 2014 22:54:50 +0200
Subject: [PATCH] HACK/quick-fix: disable dri3

Signed-off-by: Hans de Goede <hdegoede@redhat.com>
---
 configure.ac | 14 ++++++++------
 1 file changed, 8 insertions(+), 6 deletions(-)

diff --git a/configure.ac b/configure.ac
index b3b6e8e..2937afc 100644
--- a/configure.ac
+++ b/configure.ac
@@ -248,7 +248,8 @@ if test "x$shm" = "xyes"; then
 		  AC_MSG_RESULT(assuming no))
 fi
 
-PKG_CHECK_MODULES(X11_DRI3, [xcb-dri3 xcb-sync xcb-present x11-xcb xshmfence x11 xrender xext libdrm], [x11_dri3="yes"], [x11_dri3="no"])
+dnl PKG_CHECK_MODULES(X11_DRI3, [xcb-dri3 xcb-sync xcb-present x11-xcb xshmfence x11 xrender xext libdrm], [x11_dri3="yes"], [x11_dri3="no"])
+x11_dri3="no"
 AM_CONDITIONAL(X11_DRI3, test "x$x11_dri3" = "xyes" -a "x$shm" = "xyes")
 
 AC_ARG_ENABLE(tools,
@@ -264,7 +265,8 @@ fi
 if test "x$tools" != "xno"; then
 	ivo_requires="xinerama xrandr xdamage xfixes xcursor xtst xrender xext x11 pixman-1"
 	PKG_CHECK_MODULES(IVO, [$ivo_requires], [ivo="yes"], [ivo="no"])
-	PKG_CHECK_MODULES(IVO_DRI3, [xcb-dri3 xcb-sync x11-xcb xshmfence x11], [ivo_dri3="yes"], [ivo_dri3="no"])
+	dnl PKG_CHECK_MODULES(IVO_DRI3, [xcb-dri3 xcb-sync x11-xcb xshmfence x11], [ivo_dri3="yes"], [ivo_dri3="no"])
+	ivo_dri3="no"
 	if test "x$ivo_dri3" = "xyes"; then
 		IVO_CFLAGS="$IVO_CFLAGS $IVO_DRI3_CFLAGS -DDRI3"
 		IVO_LIBS="$IVO_LIBS $IVO_DRI3_LIBS"
@@ -520,10 +522,10 @@ if test "x$DRI" != "xno"; then
 		CFLAGS=$save_CFLAGS
 	fi
 
-	XORG_DRIVER_CHECK_EXT(DRI3, dri3proto)
-	if test "x$_EXT_CHECK" != "xno"; then
-		PKG_CHECK_MODULES(DRI3, [dri3proto], [DRI3=$DRI], [])
-	fi
+	dnl XORG_DRIVER_CHECK_EXT(DRI3, dri3proto)
+	dnl if test "x$_EXT_CHECK" != "xno"; then
+	dnl	PKG_CHECK_MODULES(DRI3, [dri3proto], [DRI3=$DRI], [])
+	dnl fi
 	if test "x$DRI3" != "xno"; then
 		save_CFLAGS=$CFLAGS
 		CFLAGS="$XORG_CFLAGS $DRI3_CFLAGS"
-- 
2.0.0

