# $Id: PKGBUILD 212864 2014-05-15 22:57:17Z eric $
# Maintainer: Eric BÃ©langer <eric@archlinux.org>

pkgname=mutagen
pkgver=1.23
pkgrel=1
pkgdesc="An audio metadata tag reader and writer"
arch=('any')
url="http://code.google.com/p/mutagen/"
license=('GPL2')
depends=('python2')
source=(https://bitbucket.org/lazka/mutagen/downloads/${pkgname}-${pkgver}.tar.gz)
sha1sums=('be72275ecded3bf41da5e44234d075deb71f5f62')

check() {
  cd ${pkgname}-${pkgver}
  LANG=en_US.UTF8 python2 setup.py test
}

package() {
  cd ${pkgname}-${pkgver}
  python2 setup.py install --root="${pkgdir}"
  install -d "${pkgdir}/usr/bin"
  install -m755 tools/* "${pkgdir}/usr/bin"
  sed -i 's|^#!.*/usr/bin/env.*python|#!/usr/bin/env python2|' "${pkgdir}"/usr/bin/* \
    "${pkgdir}/usr/lib/python2.7/site-packages/mutagen/__init__.py"
}
